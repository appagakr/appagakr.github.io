{"_path":"/web/was001","_dir":"web","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Apache 2.x + Tomcat 설정","description":"apache 2.x에서 SSL 설정과 tomcat으로 proxy 하는 아파치 설정","cover":"/img/was/was001_cover.jpg","date":"2022-04-01T00:00:00.000Z","layout":"article","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"apache-2x-tomcat-설정"},"children":[{"type":"text","value":"Apache 2.x + Tomcat 설정"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"apache 2.x에서 SSL 설정과 tomcat으로 proxy 하는 아파치 설정이다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"80"}]},{"type":"text","value":" 포트로 접속을 시도하면 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"443"}]},{"type":"text","value":" 포트로 리다이렉트 하도록 설정하여 언제나 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https://"}]},{"type":"text","value":" 프로토콜로 제공되도록 한다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tomcat으로 proxy하여 원하는 url을 tomcat에서 제공하도록 설정한다.\r\n만약 tomcat으로 proxy 하지 않도록 하려면 느낌표 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"!"}]},{"type":"text","value":"로 proxy에서 예외처리 한다."}]},{"type":"element","tag":"h2","props":{"id":"_80-포트를-443-포트로-리다이렉트"},"children":[{"type":"text","value":"80 포트를 443 포트로 리다이렉트"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http://"}]},{"type":"text","value":"로 접속을 시도하면 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https://"}]},{"type":"text","value":"로 전환되도록 설정한다."}]},{"type":"element","tag":"h3","props":{"id":"redirect-속성으로-하는-방법"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Redirect"}]},{"type":"text","value":" 속성으로 하는 방법"}]},{"type":"element","tag":"code","props":{"code":"<VirtualHost *:80>\r\nServerName appaga.kr\r\nRedirect permanent / https://appaga.kr/\r\n</VirtualHost>\n","language":"xml","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" *:80>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"ServerName appaga.kr\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"Redirect permanent / https://appaga.kr/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"rewriteengine-으로-하는-방법"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"RewriteEngine"}]},{"type":"text","value":" 으로 하는 방법"}]},{"type":"element","tag":"code","props":{"code":"<VirtualHost *:80>\r\nServerName appaga.kr\r\nRewriteEngine On\r\nRewriteCond %{HTTPS} off\r\nRewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R,L]\r\n</VirtualHost>\n","language":"xml","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" *:80>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"ServerName appaga.kr\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"RewriteEngine On\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"RewriteCond %{HTTPS} off\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R,L]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"_443-포트-ssl-설정"},"children":[{"type":"text","value":"443 포트 SSL 설정"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"발급받은 SSL 인증서 파일들을 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/etc/httpd/ssl/2020/"}]},{"type":"text","value":" 폴더에 저장하여 사용한다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tomcat은 8080 포트로 실행 중이며 proxy를 이용하여 모든 요청을 tomcat으로 전달 시킨다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"만약 tomcat으로 proxy 하지 않도록 하려면 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ProxyPass /resources !"}]},{"type":"text","value":" 처럼 느낌표 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"!"}]},{"type":"text","value":"로 proxy에서 예외처리 한다."}]},{"type":"element","tag":"code","props":{"code":"Listen 443 https\r\nSSLPassPhraseDialog exec:/usr/libexec/httpd-ssl-pass-dialog\r\nSSLSessionCache         shmcb:/run/httpd/sslcache(512000)\r\nSSLSessionCacheTimeout  300\r\n\r\nSSLRandomSeed startup file:///dev/urandom  256\r\nSSLRandomSeed connect builtin\r\n\r\nSSLCryptoDevice builtin\r\n\r\n<VirtualHost *:443>\r\n ServerAdmin webmaster@localhost\r\n DocumentRoot /var/www/html\r\n ServerName appaga.kr\r\n\r\n ErrorLog logs/error.log\r\n CustomLog logs/access.log combined\r\n\r\n SSLEngine on\r\n SSLProtocol all -SSLv2 -SSLv3\r\n SSLCipherSuite ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:!RC4:HIGH:!MD5:!aNULL:!EDH\r\n\r\n SSLCertificateFile      /etc/httpd/ssl/2020/appaga.kr.crt\r\n SSLCertificateKeyFile   /etc/httpd/ssl/2020/appaga.kr.key\r\n SSLCACertificateFile /etc/httpd/ssl/2020/appaga.kr.crt\r\n\r\n ProxyRequests Off\r\n ProxyPreserveHost On\r\n\r\n <Proxy *>\r\n  Order deny,allow\r\n  Allow from all\r\n </Proxy>\r\n\r\n ProxyPass /resources !\r\n ProxyPass / http://127.0.0.1:8080/\r\n ProxyPassReverse / http://127.0.0.1:8080/\r\n <Location />\r\n  Order allow,deny\r\n  Allow from all\r\n </Location>\r\n\r\n</VirtualHost>\n","language":"xml","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"Listen 443 https\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLPassPhraseDialog exec:/usr/libexec/httpd-ssl-pass-dialog\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLSessionCache         shmcb:/run/httpd/sslcache(512000)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLSessionCacheTimeout  300\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLRandomSeed startup file:///dev/urandom  256\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLRandomSeed connect builtin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"SSLCryptoDevice builtin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" *:443>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ServerAdmin webmaster@localhost\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" DocumentRoot /var/www/html\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ServerName appaga.kr\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ErrorLog logs/error.log\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" CustomLog logs/access.log combined\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLEngine on\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLProtocol all -SSLv2 -SSLv3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLCipherSuite ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:!RC4:HIGH:!MD5:!aNULL:!EDH\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLCertificateFile      /etc/httpd/ssl/2020/appaga.kr.crt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLCertificateKeyFile   /etc/httpd/ssl/2020/appaga.kr.key\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" SSLCACertificateFile /etc/httpd/ssl/2020/appaga.kr.crt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ProxyRequests Off\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ProxyPreserveHost On\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" <"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"Proxy"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" *>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"  Order deny,allow\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"  Allow from all\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" </"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"Proxy"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ProxyPass /resources !\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ProxyPass / http://127.0.0.1:8080/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" ProxyPassReverse / http://127.0.0.1:8080/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" <"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"Location"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" />\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"  Order allow,deny\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"  Allow from all\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":" </"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"Location"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-135469"},"children":[{"type":"text","value":"VirtualHost"}]},{"type":"element","tag":"span","props":{"class":"ct-11bbbd"},"children":[{"type":"text","value":">"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-135469{color:#116329}\n.ct-11bbbd{color:#24292F}\n.dark .ct-11bbbd{color:#C9D1D9}\n.dark .ct-135469{color:#7EE787}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"_80-포트를-443-포트로-리다이렉트","depth":2,"text":"80 포트를 443 포트로 리다이렉트","children":[{"id":"redirect-속성으로-하는-방법","depth":3,"text":"Redirect 속성으로 하는 방법"},{"id":"rewriteengine-으로-하는-방법","depth":3,"text":"RewriteEngine 으로 하는 방법"}]},{"id":"_443-포트-ssl-설정","depth":2,"text":"443 포트 SSL 설정"}]}},"_type":"markdown","_id":"content:web:was001.md","_source":"content","_file":"web/was001.md","_extension":"md"}